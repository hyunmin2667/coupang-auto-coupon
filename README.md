# Coupang 자동 쿠폰 관리 프로그램

이 프로그램은 쿠팡 판매자 센터(WING)의 쿠폰을 **자동으로 관리**해주는 편리한 도구입니다. 기존에 만들어진 특정 쿠폰을 비활성화하고, 새로운 쿠폰을 만들어서 미리 정해둔 상품들에 자동으로 적용해줍니다. 모든 과정은 기록되며, 설정한 디스코드 채널로 알림까지 받을 수 있습니다.


## 💡 주요 기능 요약

* **자동 쿠폰 비활성화**: 이전에 "자동쿠폰\_"이라는 이름으로 만든 활성 쿠폰들을 자동으로 찾아 비활성화합니다.
* **새 쿠폰 자동 생성**: 현재 시간을 기준으로 새로운 할인율과 최대 할인 금액이 적용된 쿠폰을 만듭니다.
* **상품에 쿠폰 자동 적용**: `vendor_items.csv` 파일에 등록된 상품들에 새로 만든 쿠폰을 자동으로 적용합니다.
* **반복 실행 (스케줄링)**: 설정된 시간(기본 60분)마다 쿠폰 갱신 작업을 자동으로 반복합니다.
* **Discord 알림**: 쿠폰 자동화 작업이 성공했는지, 실패했는지 디스코드 웹훅을 통해 실시간으로 알려줍니다.
* **상세 기록 (로깅)**: 모든 작업 과정과 발생한 문제는 화면(콘솔)과 `logs/coupang_automation.log` 파일에 자세히 기록됩니다.

---

## 🚀 프로그램을 시작하는 방법

이 프로그램을 컴퓨터에서 작동시키려면 몇 가지 간단한 준비 과정이 필요합니다. 아래 단계를 순서대로 따라해 보세요.

### 1단계: 프로그램 파일 준비하기

먼저, 이 프로그램을 컴퓨터로 다운로드해야 합니다. 아래 명령어를 **복사하여 터미널(또는 명령 프롬프트)에 붙여넣고 엔터**를 누르세요.

```bash
git clone https://github.com/hyunmin2667/coupang-auto-coupon.git
cd coupang-auto-coupon
```

### 2단계: 프로그램 작동을 위한 초기 설치

이제 프로그램이 제대로 작동하는 데 필요한 부품들을 설치할 차례입니다.

1.  **가상 환경 만들기 (매우 중요!)**:
    프로그램 파일을 다운로드한 폴더(이름: `coupang-auto-coupon`) 안에서 다음 명령어를 **복사하여 터미널에 붙여넣고 엔터**를 누르세요. 이 과정은 프로그램이 필요한 '부품'들을 다른 프로그램과 섞이지 않게 안전한 공간에 설치하는 작업입니다.

    ```bash
    python -m venv .venv
    ```

2.  **가상 환경 활성화**:
    가상 환경을 만들었다면, 이제 이 환경을 '활성화'해야 합니다. 사용 중인 컴퓨터의 종류에 따라 아래 명령어를 **복사하여 터미널에 붙여넣고 엔터**를 누르세요.

    * **Mac / Linux 사용자**:
        ```bash
        source ./.venv/bin/activate
        ```
    * **Windows 사용자 (명령 프롬프트/CMD)**:
        ```bash
        .venv\Scripts\activate
        ```
    * **Windows 사용자 (PowerShell)**:
        ```powershell
        .venv\Scripts\Activate.ps1
        ```

3.  **필요한 부품 설치**:
    가상 환경이 활성화된 상태에서, 프로그램 작동에 필요한 모든 부품(라이브러리)들을 설치합니다. 다음 명령어를 **복사하여 터미널에 붙여넣고 엔터**를 누르세요.

    ```bash
    pip install -r requirements.txt
    ```

### 3단계: 바로가기 만들기 (Windows)

프로그램 실행 및 주요 파일들에 쉽게 접근할 수 있도록 바로가기를 자동으로 생성해주는 스크립트가 있습니다. 이 단계에서 미리 바로가기를 만들어두면 다음 설정 작업이 훨씬 편리해집니다.

1.  프로젝트 폴더 안에 있는 `windows_shortcut_generate.vbs` 파일을 찾습니다.
2.  이 파일을 **더블클릭**하여 실행합니다.
3.  스크립트가 실행되면 프로젝트 폴더 안에 '바로가기'라는 새 폴더가 생성되고, 그 안에 다음과 같은 바로가기들이 만들어집니다:
    * `1.실행하기.lnk` (-> `windows_run.bat`)
    * `2.설정편집.lnk` (-> `.env`)
    * `3.상품목록.lnk` (-> `vendor_items.csv`)
    * `4.업데이트.lnk` (-> `windows_update.bat`)

### 4단계: 내 정보 입력하기 (아주 중요!)

이 프로그램은 쿠팡 계정 정보, 비밀 키, 디스코드 알림 주소 같은 중요한 정보를 사용합니다. 이 정보들은 `.env`라는 특별한 파일에 저장되며, 절대 다른 사람에게 보여주면 안 됩니다.

1.  `coupang-auto-coupon` 폴더 안에 있는 `.env.example`파일을 찾아서 `.env` 라는 이름으로 복사하거나 이름을 변경하세요.
    (위 `3단계`에서 만든 `2.설정편집` 바로가기를 더블클릭하면 `.env` 파일을 바로 열 수 있습니다.)
2.  새로 만든 `.env` 파일을 '메모장'이나 '텍스트 편집기'로 열어보세요.
3.  파일 안에 `"your_..."`이라고 표시된 부분들을 **당신의 실제 정보로 반드시 수정**해야 합니다. (예시: `COUPANG_ID="내_쿠팡_아이디"`)
4.  [디스코드 웹훅 URL으로 알림받는 방법을 모른다면? (클릭)](https://www.svix.com/resources/guides/how-to-make-webhook-discord/)

    ```dotenv
    # 쿠폰 할인율 (예: 50% 할인)
    COUPON_DISCOUNT_RATE=50

    # 쿠폰 최대 할인 금액 (예: 5000원)
    COUPON_MAX_DISCOUNT_PRICE=5000

    # 자동 쿠폰 갱신 주기 (기본값은 60분마다 실행)
    COUPON_CYCLE_MINUTES=60

    # 기본설정
    COUPANG_ID="your_coupang_id"
    COUPANG_PW="your_coupang_password"

    ACCESS_KEY="your_access_key"
    SECRET_KEY="your_secret_key"

    VENDOR_ID="your_vendor_id"
    CONTRACT_ID=10

    DISCORD_WEBHOOK_URL="your_discord_webhook_url"
    ```

    **꼭 기억하세요**: `.env` 파일은 절대 다른 사람과 공유하거나 온라인에 올리면 안 됩니다!

### 5단계: 쿠폰을 적용할 상품 목록 준비하기

이 프로그램이 어떤 상품에 쿠폰을 적용해야 하는지 알려줘야 합니다.

* `coupang-auto-coupon` 폴더 안에 `**vendor_items.csv**`라는 이름의 파일을 새로 만드세요.
    (위 `3단계`에서 만든 `3.상품목록` 바로가기를 더블클릭하면 `vendor_items.csv` 파일을 바로 열 수 있습니다.)
* 이 파일을 '메모장'이나 '텍스트 편집기'로 열고, **쿠폰을 적용할 상품들의 ID를 한 줄에 하나씩** 입력합니다. 가장 위에 제목 줄(헤더)은 넣지 마세요.

    ```csv
    92796688288
    92796688320
    92796688298
    ...
    ```

### 6단계: 프로그램 실행하기

이제 모든 준비가 끝났습니다! 위 5단계까지의 설정이 모두 완료되었다면, 프로그램을 실행할 수 있습니다.

* **Mac / Linux 사용자**:
    터미널을 열고 다음 명령어를 **복사하여 붙여넣고 엔터**를 누르세요.

    ```bash
    chmod +x mac_run.sh
    ./mac_run.sh
    ```

* **Windows 사용자 (`windows_run.bat`)**:
    제공된 `windows_run.bat` 파일을 사용하여 프로그램을 실행할 수 있습니다.
    가장 쉬운 방법은 **`3단계`에서 만든 `1.실행하기` 바로가기를 더블클릭**하는 것입니다.
    또는, 명령 프롬프트(CMD)를 열고 다음 명령어를 **복사하여 붙여넣고 엔터**를 눌러 실행할 수도 있습니다:

    ```cmd
    windows_run.bat
    ```
    프로그램 실행 후 뜨는 명령 프롬프트 창을 닫지 않고 유지하면, 설정된 시간(예: 60분)마다 프로그램이 자동으로 실행되어 쿠폰을 갱신합니다.

## ✨ 프로그램 업데이트 (Windows)

프로그램을 최신 상태로 유지하려면 `windows_update.bat` 파일을 사용하세요. 이 파일을 **`3단계`에서 만든 `4.업데이트` 바로가기를 더블클릭**하여 실행하면, 프로그램의 최신 버전으로 업데이트되고 필요한 부품들도 자동으로 설치됩니다.

---

## ‼️ 디스코드 알림 설정 후, 실패 알림만 받는 방법
- 실패 알림은 `@everyone` 멘션으로 알림이 옵니다. 
- 따라서 아래 사진과 같이 설정 시, 성공은 메세지가 와도 푸시 알림이 없으며 실패시 메세지에 멘션을 포함하여 푸시 알림을 받을 수 있습니다.

![alt text](docs/images/picture.png)

---

## 🧑‍💻 파일 구조

프로그램 폴더의 주요 파일 및 폴더는 다음과 같습니다.

```
.
├── .env                  # 환경 변수 설정 파일 (사용자가 생성, .gitignore에 포함)
├── .gitignore            # Git에서 추적하지 않을 파일/폴더 목록
├── .env.example          # .env 파일 생성을 위한 예시 파일
├── main.py               # 메인 스크립트 (쿠폰 자동화 로직)
├── requirements.txt      # Python 의존성 목록
├── vendor_items.csv      # 쿠폰 적용 대상 품목 ID (사용자가 생성)
├── windows_shortcut_generate.vbs # 바로가기 자동 생성 스크립트 (Windows)
├── coupang_lib/
│   ├── __init__.py
│   ├── api_client.py         # 쿠팡 API와 통신하는 클라이언트 로직
│   ├── config.py             # 설정 변수 관리
│   ├── coupang_api_utils.py  # 쿠팡 API 호출 관련 유틸리티 함수
│   ├── coupang_wing_selenium.py # Selenium을 이용한 쿠팡 WING 자동화 (선택적 사용)
│   ├── discord_notifier.py   # Discord 알림 전송 기능
│   ├── item_loader.py        # vendor_items.csv 파일 로드 기능
│   └── logger.py             # 로깅 설정
└── logs/                 # 스크립트 실행 로그 저장 디렉토리 (자동으로 생성됨)
    └── coupang_automation.log
```


















